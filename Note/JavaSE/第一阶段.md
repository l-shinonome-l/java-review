# Java概述
## Java的版本和组成
程序：**有序**指令的**集合**->解决问题。

Java 8、Java 11、Java 17、Java 21 LTS（Long-Term-Support）版本，需要重点学习feature。
> [!TIP]
> Java 17、Java 21本课程内没有，要再找资料学习。

Java技术体系平台：
- Java SE（Java Standard Edition）标准版
- Java EE（Java Enterprise Edition）企业版
- Java ME（Java Micro Edition）小型版（被Android替代了）

## Java的特点
Java的重要特点（不全，只有重点的）
1. 面向对象的（oop）。
2. 健壮的（rubust）。（强类型机制、异常处理、垃圾自动回收等保证健壮性）
3. 跨平台的。（.java文件编译为.class文件后，在不同平台的机器上运行不用再次编译，一次**编译**，Java虚拟机实现）
4. 半解释型半编译型[^1]（解释型：Javascript、PHP、Python，编译型：c/c++，编译后要解释器才能执行还是能直接被机器执行）
> [!NOTE]
> JVM中编译和解释并行存在，一开始是纯解释，但为了提高运行效率，加入JIT编译器（Just In Time Complier），将部分代码（以method为单位）编译为目标机器语言并保存提高效率。
[^1]:和课程内的不同，参考教科书和Javaguide进行了修正。

## Java开发工具
- editplus、notepad++
- Sublime Text
- **IDEA**
- eclipse
- **Visual Studio Code**

## jdk介绍
Java运行机制及运行过程：
.java文件编译为.class文件，.class在Java虚拟机（JVM）上运行，JVM通过屏蔽底层运行平台的差别，实现跨平台性。

JVM（Java Virtual Machine）：Java虚拟机，有指令集和不同的存储区域，负责执行指令，管理数据、内存、寄存器，不同系统平台要安装不同的JVM，在Java 9之前都在JRE里。

JRE（Java Runtime Environment）：Java运行时环境，一般包括JVM和Java基础类库（Java Class Library），有JRE就可以运行.class文件，在JDK里。Java 9开始将jdk模块化，并提供jlink工具，来根据程序需要生成JRE，从Java 11开始不提供单独的JRE下载。

JDK（Java Development Kit）：Java开发工具包，它包含了 JRE和javac（编译.java为.class的编译器）、javadoc（文档注释工具）、JDB（Java Debugger，调试器）、jconsole（基于JMX（Java管理扩展，Java Management Extensions）的可视化监控⼯具）、javap（反编译工具）等工具。

Java 9前：JVM $`\in`$ JRE $`\in`$ JDK。

## 开发细节
1. .java文件由类组成。
2. 执行入口`main()`，固定写为`public static void main(String[] args){}`。
3. 严格区分大小写。
4. 语句以`;`结束。
5. 一个.java文件最多有一个public类，其他类不作限制，编译后每个类对应生成一个.class文件。
6. 如存在public类，.java文件必须要以这个public类的名字命名。
7. `main()`方法可以不在public类里，命令行运行指定类（.class文件）就可以访问非公共类里的main方法，IDE必须设定run Configurations的Main class。

## 转义字符
1. `\t`：制表位，实现对齐。
2. `\n`：换行。
3. `\\`：一个\\。
4. `\"`：一个\"。
5. `\'`：一个\'。
6. `\r`：一个回车，光标回到开头，不加`\n`则后面的字会覆盖前面的。

## 注释
注释：用于注解说明解释代码的文字，提高代码可读性。（快捷键：选中内容后ctrl+/，再按取消）
- 单行注释：`//注释内容`。
- 多行注释：`/*注视内容*/`。（无法嵌套）
- 文档注释：可被javadoc解析，写在类前，`@author`、`@version`等是javadoc标签，如下面代码块的.java文件可通过命令`javadoc -d output_path -author -version file_name`生成网页文件形式的说明文档。
```
/**
 * @author
 * @version
 */
```

## 代码规范
1. 类、方法的注释用javadoc的方法写。
2. 非javadoc的注释注重为什么这么写、如何修改、注意问题等。
3. 使用tab键缩紧，不要用多个空格。
4. 运算符和=左右加空格。
5. 源文件使用 utf-8 编码。
6. 行宽不要超过 80 个字符。
7. 次行风格、**行尾风格**（目前比较常见）：换行左大括号还是行尾左大括号。

# Java语法基础

## 变量
变量 = 类型 + 名称（地址） + 值

注意事项：
1. 先声明，后使用。
2. 同一作用域里不能重名。

### 基础变量类型
1 字节（byte） = 8 位（bit），1B = 8b。

- 数值型
  - 整数类型：1位符号位，其余数值位
    - byte：1 字节，- 2<sup>7</sup>~2<sup>7</sup> - 1，-128～127
    - short：2 字节，- 2<sup>15</sup>~2<sup>15</sup> - 1，-32768～32767
    - int：4 字节，- 2<sup>31</sup>~2<sup>31</sup> - 1，-2147483648～2147483647
    - long：8 字节，- 2<sup>63</sup>~2<sup>63</sup> - 1，具体值默认为int，要加`l`或`L`才能指定为long，如`1L`。
  - 浮点（小数）类型：符号位 + 指数位 + 尾数位（尾数部分可能丢失->精度损失，注意浮点数除法，小数相等判断时用差值绝对值在某个精度范围内）
    - float：4 字节，-3.403E38～3.403E38，具体值默认为double，要加`f`或`F`才能指定为float，如`1.1F`。
    - double：8 字节，-1.798E308～1.798E308
- 字符型
  - char：2 字节，也可以存放汉字，常量用单引号，本质是一个整数，代表unicode码对应字符，可运算，多个字符可以用String。
- 布尔型
  - boolean：1 字节，true/false，没有null。
### 类型转换
char->int->long->float->double

byte->short->int->long->float->double

**范围大的类型不能直接赋值给范围小的，范围小的类型赋值给范围大的或者和范围大的运算会自动转型**

#### 自动类型转换
注意事项：
- 多种类型混合计算会先转成最大的再计算。
- **具体数值**赋给byte、short和char时，虽然默认是int类型的，但会先判断范围，在范围内不会报错。
- byte和short有负数，char的范围是0～2<sup>16</sup>-1，（byte，short）和char之间没有包含关系，无法转换
- byte、short、char只要进行计算就会转换为int类型，不管是单类型运算还是混合运算。
- boolean不参与自动转换。
- 表达式的结果为操作数中最大的类型。

#### 强制类型转换
将容量大的数据类型转为容量小的数据类型，加上强制转换符`()`，只对最近的操作数有效。

不注意会导致127+1=-128这类bug，特别是底层隐形地使用了强制转换的时候（如++、+=）。

#### 基本数据类型和String类型转换
- 基本数据类型->String类型：最后加`+""`就行。
- String类型->基本数据类型：基本类型的包装类调用.parseXX方法，如`int a = Integer.parseInt("123")`。得到某一位字符用`.charAt()`。要确保能转为目标数据，不然会抛出异常。

### 引用数据类型
- 类（class）
  - String
    - 判断字符串相等用.equals()方法。
- 接口（interface）
- 数组（[]）

## 运算符
### 算数运算符
1. +：正号或加，左右两边是数值型，做加法；有一侧是字符串，做拼接。
2. -：负号或减
3. *：乘
4. /：除
5. %：取模，a % b = a - (int) (a / b) * b
6. ++/--：自增/减，`++i`，在前先运算再取值，`i++`，在后先取值再运算，有强制类型转换，所以byte、short、char也可以用。
```
//一个容易弄混的案例
int i = 1;
i = i++;  //1

int j = 1
j = ++j;  //2
```

### 赋值运算符
左边只能是变量，先执行右边，再赋值给左边

基本赋值运算符：=，赋值语句作为判断条件的话，根据被赋值的变量的值来判断true/false。

复合赋值运算符：+=、-=、*=、/=，会进行类型强制转换，等价于`a = (a的类型) a + _`所以byte、short、char也可以用。

### 关系运算符
结果是boolean
1. ==：等于
2. !=：不等于
3. <：小于
4. \>：大于
5. <=：小于等于
6. \>=：大于等于
7. instanceof：检查是否是累的对象 `"123" instanceof String  //true`

### 逻辑运算符
结果是boolean
1. &&：短路与，左侧为false则不会执行右边
2. ||：短路或，左侧为true则不会执行右边
3. !：取反
4. &：逻辑与，不短路，可用于位运算，按位与
5. |：逻辑或，不短路，可用于位运算，按位或
6. ^：异或，按位异或
### 三元运算符
`条件表达式 ? 表达式1 : 表达式2`

条件表达式为true则为表达式1，false则为表达式2。

表达式1和表达式2要为可以被变量接收的类型（或可以自动转换的类型）
### 优先顺序
运算顺序：除单目运算符和赋值运算符都是从左到右。
从上往下降低
- .  ()  {}  ;  ,
- ++  --  ~  !  (data type)
- \*  /  %
- \+  -
- \>>  <<  >>>  位移
- <  \>  <=  >=  instanceof
- ==  !=
- &
- ^
- |
- &&
- ||
- ?:
- =  *=  /=  %/  +=  -=  <<=  >>=  >>>=  &=  ^=  |=

## 标识符
可以自己取名的地方
### 规则
1. 由26个英文字母大小写，0-9，_或$组成
2. 数字不可以开头
3. 不能用关键字和保留字，但能包含
4. 严格区分大小写，无长度限制
5. 不能有空格
### 规范
1. 包名：多单词组成时所有字母小写
2. 类名、接口名：多单词组成时，所有单词首字母大写
3. 变量名、方法名：多单词组成时，第一个单词首字母小写，后面的首字母大写
4. 常量名：所有字母大写，多单词用下划线连接
### 关键字
都是小写
定义数据类型的

class、interfac、enum、byte、short、int、long、float、double、char、boolean、void

定义数据类型的值的

true、false、null

定义流程控制的

if、else、switch、case、default、while、do、for、break、continue、return
### 保留字
现版本没有使用，以后可能使用的

byValue、cast、future、generic、inner、operator、outer、rest、var、goto、const
## 键盘输入语句
扫描器Scanner类，所在包为java.util.*

步骤：
1. 导入包
2. 创建Scanner实例`Scanner scanner = new Scanner(System.in);`
3. 调用功能`String s = scanner.next()  // s为输入的下一行字符串`

## 四种进制
1. 二进制：0b或0B开头
2. 十进制：默认进制
3. 八进制：0开头
4. 十六进制：0x或0X开头，a-f不区分大小写

## 位运算
### 位运算符号
1. <<：算数左移，符号位不变，低位补0
2. \>>：算数右移，符号位不变，低位舍弃，用符号位补高位
3. \>>>：逻辑右移/无符号右移，低位舍弃，高位补0
4. ~：按位取反
5. &：按位与
6. |：按位或
7. ^：按位异或

### 原码、反码、补码
1. 二进制最高位是符号位，0是正数，1是负数
2. 正数的原码、反码、补码都一样
3. 负数的反码=原来的符号位+其他位取反
4. 负数的补码=负数的反码+1
5. 0的反码和补码都是0
6. java没有无符号数
7. 计算机用补码运算！！
8. 运算结果看原码！！

## 控制语句
- 顺序控制：从上往下执行
- 分支控制：具体数值不多且符合switch的6种类型就用switch，区间、true/false判断用if-else。
  - if-else（嵌套最好不要超过3层）
    ```
    if (条件表达式) {
        代码块
    } else if (条件表达式) {
        代码块
    } else {
        代码块
    }
    ```
  - switch
    ```
    switch (表达式){  //表达式应是后续常量的类型或者后续常量能转换成可以比较的类型，表达式只能是byte、short、int、char、enum、String
        case 常量1:
            代码块;
            break;  //没有break会穿透（不用判断case）执行后面的代码块，可用于处理多个case要执行统一操作
        case 常量2:
            代码块;
            break;
        ...
        default:
            代码块;
    }
    ```
- 循环控制（嵌套不要超过3层最好，最多不要超过4层）
  - for
    ```
    for (循环变量初始化;循环条件;循环变量迭代) { // 循环变量初始化和循环变量迭代可以省略，但分号要有，可以初始化多个变量，但类型要一样，变量迭代也可以有多个
        代码块
    }
    ```
  - while
    ```
    循环变量初始化
    while (循环条件) {
        代码块
        循环变量迭代
    }
    ```
  - do-while（一定会执行一次）
    ```
    循环变量初始化
    do {
        代码块
        循环变量迭代
    } while (循环条件);
    ```
- break：跳出当前循环/switch分离case，（尽量不要用）配合标签在多重循环中退出哪一层，标签放在循环语句前`标签:`，`break 标签;`
- continue：跳过之后的循环体，进入下一次循环，（尽量不要用）配合标签在多重循环中跳过哪一层，标签放在循环语句前`标签:`，`continue 标签;`
- return：在方法中使用，跳出所在方法
